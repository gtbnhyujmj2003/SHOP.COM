å¯«ä¸€å€‹åŠŸèƒ½: ç”¨socketæ¥æ”¶å­—ä¸²


ChatGPT èªªï¼š
å¥½çš„ï¼ä½ æƒ³å¯«ä¸€å€‹åŠŸèƒ½ã€Œç”¨ Socket æ¥æ”¶å­—ä¸²ã€ï¼Œé€™ä»£è¡¨ä½ éœ€è¦ä¸€å€‹ç°¡å–®çš„ TCP Serverï¼ˆä¼ºæœç«¯ï¼‰ç”¨ä¾†æ¥æ”¶ä¾†è‡ª client çš„å­—ä¸²ã€‚

é€™è£¡æˆ‘æä¾›ä¸€ä»½ç”¨ Dartï¼ˆé©ç”¨ Flutter é …ç›®ä¹Ÿèƒ½é‡ç”¨ï¼‰å¯«çš„ Socket server ç¯„ä¾‹ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¾†è‡ª client çš„å­—ä¸²è³‡æ–™ï¼š

âœ… Dart Socket Serverï¼šæ¥æ”¶å­—ä¸²çš„åŠŸèƒ½
ğŸ“„ æª”æ¡ˆï¼šsocket_server.dart
dart
è¤‡è£½
ç·¨è¼¯
import 'dart:io';
import 'dart:convert';

void main() async {
  final server = await ServerSocket.bind(InternetAddress.anyIPv4, 4040);
  print('âœ… Saki Server å·²å•Ÿå‹•ï¼Œåœ¨ port 4040 ç­‰å¾…é€£ç·š...');

  await for (Socket client in server) {
    print('ğŸ“¥ æ”¶åˆ°é€£ç·šï¼š${client.remoteAddress.address}:${client.remotePort}');

    client.listen((data) {
      final message = utf8.decode(data);
      print('ğŸ’¬ Saki æ”¶åˆ°å­—ä¸²ï¼š$message');

      // å›å‚³çµ¦ clientï¼ˆå¯é¸ï¼‰
      client.write('Saki æ”¶åˆ°ä½ çš„è¨Šæ¯ï¼š$message');
    });
  }
}
ğŸ“¤ æ¸¬è©¦æ–¹å¼ï¼ˆTerminal æˆ–è‡ªå·±å¯« clientï¼‰ï¼š
âœ… ç”¨ telnet æ¸¬è©¦ï¼ˆWindows / macOS / Linux çµ‚ç«¯æ©Ÿï¼‰
bash
è¤‡è£½
ç·¨è¼¯
telnet 127.0.0.1 4040
æ¥è‘—ä½ è¼¸å…¥ï¼š

nginx
è¤‡è£½
ç·¨è¼¯
hello saki
Saki server æœƒå›æ‡‰ï¼š

nginx
è¤‡è£½
ç·¨è¼¯
Saki æ”¶åˆ°ä½ çš„è¨Šæ¯ï¼šhello saki
ğŸ’¡ å¦‚æœä½ æƒ³è¦ Flutter App ç•¶ Client å‘¢ï¼Ÿ
dart
è¤‡è£½
ç·¨è¼¯
import 'dart:io';
import 'dart:convert';

void sendToSaki(String message) async {
  final socket = await Socket.connect('127.0.0.1', 4040);
  print('âœ… å·²é€£ä¸Š Saki Server');

  socket.write(message);

  socket.listen((data) {
    print('ğŸŸ¢ æ”¶åˆ° Saki å›æ‡‰ï¼š${utf8.decode(data)}');
    socket.destroy(); // é—œé–‰é€£ç·š
  });
}

void main() {
  sendToSaki('Hello from Flutter client!');
}
âœ… å»ºè­°ä½ åœ¨æœ¬æ©Ÿè·‘ socket_server.dart å¾Œï¼Œå•Ÿå‹• Client ä¾†æ¸¬è©¦æ•´å€‹æµç¨‹ã€‚

ğŸ” æ³¨æ„äº‹é …
å•é¡Œ	è§£æ³•
Port è¢«é˜²ç«ç‰†æ“‹	æœ¬åœ°æ¸¬è©¦ä½¿ç”¨ localhost å³å¯ï¼Œéƒ¨ç½²æ™‚è¦è¨­å®šé–‹æ”¾ port
Flutter ç„¡æ³•ç›´æ¥ç”¨ server åŠŸèƒ½	Flutter æ˜¯å‰ç«¯ï¼Œåƒ…é©åˆç•¶ clientï¼ŒDart å¯ç•¶ server
å­—å…ƒäº‚ç¢¼	ç”¨ utf8.decode(data) è™•ç†

éœ€è¦æˆ‘å¹«ä½ æ”¹é€ æˆ Flutter UIï¼Œè®“ä½¿ç”¨è€…è¼¸å…¥æ–‡å­—ä¸¦é€åˆ° server å—ï¼Ÿé‚„æ˜¯ä½ è¦åšèŠå¤©å®¤ã€IoTã€æˆ–å•†æ¥­è³‡æ–™åŒæ­¥ï¼Ÿè«‹èªªæ˜ï¼Œæˆ‘å¯ä»¥å¹«ä½ å»ºå®Œæ•´çš„ socket æ¶æ§‹ã€‚
